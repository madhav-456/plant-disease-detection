<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Subsidy Finder | AgroTech</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Poppins', sans-serif; background-color: #f9fafb; }
    .hero-gradient { background: linear-gradient(135deg, #4ade80 0%, #3b82f6 100%); }
    .glow-text { text-shadow: 0 0 10px rgba(74, 222, 128, 0.7); }
    .subsidy-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); }
  </style>
</head>
<body>
  <!-- ✅ Navbar, Hero, How it Works, Testimonials, FAQ, CTA, Footer remain the same -->

  <!-- ✅ Only One Subsidy Section -->
  <section class="py-16 bg-gray-50 px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">Available <span class="text-green-500">Subsidies</span></h2>
        <p class="text-lg text-gray-500 max-w-3xl mx-auto">Explore government schemes that can benefit your farming operations</p>
      </div>
      <div class="max-w-2xl mx-auto mb-8">
        <input id="searchBox" type="text" placeholder="Search subsidies by keyword..."
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"/>
      </div>
      <div class="max-w-2xl mx-auto mb-4">
        <label class="block text-gray-700 mb-2 font-medium">Sort by:</label>
        <select id="sortSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
          <option value="name">Scheme Name (A-Z)</option>
          <option value="type">Scheme Type</option>
        </select>
      </div>
      <div id="subsidyResults" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      <!-- Pagination -->
      <div id="paginationControls" class="flex justify-center mt-8 space-x-2">
        <button id="prevPage" class="px-4 py-2 bg-gray-200 rounded-md hover:bg-green-500 hover:text-white disabled:opacity-50"><i class="fas fa-chevron-left"></i></button>
        <div id="pageNumbers" class="flex space-x-2"></div>
        <button id="nextPage" class="px-4 py-2 bg-gray-200 rounded-md hover:bg-green-500 hover:text-white disabled:opacity-50"><i class="fas fa-chevron-right"></i></button>
      </div>
    </div>
  </section>

  <!-- ✅ JavaScript (fixed event listeners) -->
  <script>
    const subsidyData = { subsidy_schemes: [
      { id:1, name:"PM-KISAN", type:"Central Sector", description:"Provides Rs.6000 annually to farmers." },
      { id:2, name:"PM-KMY", type:"Central Sector", description:"Pension scheme for small farmers." },
      { id:3, name:"Pradhan Mantri Fasal Bima Yojana (PMFBY)", type:"Central Sector", description:"Crop insurance scheme." }
      // ➝ Add more schemes here (cleaned & consistent)
    ]};

    let currentPage = 1, itemsPerPage = 6;

    function renderSubsidies() {
      const searchVal = document.getElementById("searchBox").value.toLowerCase();
      const sortBy = document.getElementById("sortSelect").value;
      let filtered = subsidyData.subsidy_schemes.filter(s => 
        s.name.toLowerCase().includes(searchVal) || (s.description && s.description.toLowerCase().includes(searchVal))
      );
      filtered.sort((a,b)=> sortBy==="name"? a.name.localeCompare(b.name): a.type.localeCompare(b.type));
      const totalPages = Math.ceil(filtered.length/itemsPerPage);
      currentPage = Math.min(currentPage,totalPages);
      const start=(currentPage-1)*itemsPerPage, end=start+itemsPerPage;
      const pageItems = filtered.slice(start,end);

      document.getElementById("subsidyResults").innerHTML = pageItems.map(s=>`
        <div class="bg-white rounded-lg shadow-md p-6 subsidy-card">
          <h3 class="font-bold text-lg text-gray-800 mb-2">${s.name}</h3>
          <span class="inline-block text-sm px-2 py-1 rounded bg-green-100 text-green-700 mb-3">${s.type}</span>
          <p class="text-gray-600">${s.description||""}</p>
        </div>
      `).join("");

      // Pagination
      document.getElementById("pageNumbers").innerHTML = Array.from({length:totalPages},(_,i)=>`
        <button onclick="goToPage(${i+1})" class="px-3 py-1 rounded ${i+1===currentPage?"bg-green-500 text-white":"bg-gray-200"}">${i+1}</button>
      `).join("");
      document.getElementById("prevPage").disabled = currentPage===1;
      document.getElementById("nextPage").disabled = currentPage===totalPages;
    }

    function goToPage(p){ currentPage=p; renderSubsidies(); }

    document.getElementById("searchBox").addEventListener("input",()=>{ currentPage=1; renderSubsidies(); });
    document.getElementById("sortSelect").addEventListener("change",()=>renderSubsidies());
    document.getElementById("prevPage").addEventListener("click",()=>{ if(currentPage>1){currentPage--; renderSubsidies();} });
    document.getElementById("nextPage").addEventListener("click",()=>{ currentPage++; renderSubsidies(); });

    renderSubsidies();
  </script>
</body>
</html>
